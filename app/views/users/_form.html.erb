<%= form_with(model: @user, url: usuarios_path(@user), local: true, class: "centered-form") do |form| %>
  <% if @user.errors.any? %>
    <div class="alert alert-danger">
      <h2><%= pluralize(@user.errors.count, "error") %> prohibited this user from being saved:</h2>
      <ul>
        <% @user.errors.full_messages.each do |error| %>
          <li><%= error %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="form-row justify-content-center">
    <div class="col-md-12">
      <div class="text-left">
        <%= form.label :email %>
        <%= form.email_field :email, required: true, class: "form-control" %>
      </div>

      <div class="text-left">
        <%= form.label :nome %>
        <%= form.text_field :nome, required: true, class: "form-control" %>
      </div>

      <div class="form-check form-check-inline text-left">
        <%= form.label :consultor, "Consultor", class: "form-check-label me-2" %>
        <%= form.check_box :consultor, class: "form-check-input", id: "consultor-checkbox" %>
      </div>

      <div class="text-left" id="especialidade-field" style="display: none;">
        <%= form.label :especialidade_id, "Especialidade" %>
        <%= form.select :especialidade_id, @especialidades.map { |especialidade| [especialidade.nome, especialidade.id] }, { include_blank: true }, class: "form-control" %>
      </div>

      <div class="text-left">
        <%= form.label :cidade_id, "Cidade" %>
        <%= form.select :cidade_id, @cidades.map { |cidade| [cidade.descricao, cidade.id] }, { include_blank: true }, class: "form-control" %>
      </div>

      <% if @user.new_record? %>
        <div class="text-left">
          <%= form.label :password %>
          <%= form.password_field :password, required: true, class: "form-control" %>
        </div>

        <div class="text-left">
          <%= form.label :password_confirmation %>
          <%= form.password_field :password_confirmation, required: true, class: "form-control" %>
        </div>
      <% else %>
        <div class="text-left">
          <p>Se você deseja alterar a senha, por favor, insira uma nova abaixo:</p>
          <%= form.label :password %>
          <%= form.password_field :password, class: "form-control" %>
        </div>

        <div class="text-left">
          <%= form.label :password_confirmation %>
          <%= form.password_field :password_confirmation, class: "form-control" %>
        </div>
      <% end %>
    </div>
  </div>

  <div class="form-group mt-3">
    <div class="d-flex justify-content-between">
      <div>
        <%= link_to "<i class='fas fa-arrow-left'></i>".html_safe, usuarios_path, class: "btn btn-secondary" %>
      </div>
      <div>
        <%= form.submit @user.new_record? ? "Criar Usuário" : "Atualizar Usuário", class: "btn btn-primary me-2" %>
      </div>
    </div>
  </div>
<% end %>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
  $(document).ready(function() {
    // Função para mostrar ou esconder o campo de especialidade
    $('#consultor-checkbox').change(function() {
      if ($(this).is(':checked')) {
        $('#especialidade-field').show();
      } else {
        $('#especialidade-field').hide();
      }
    });
  });
</script>
